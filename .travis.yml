language: r

r:
  - oldrel
  - release

sudo: false

cache: packages

warnings_are_errors: false

os:
  - linux
  - osx

env:
  global:
    - OS=$(uname -s)

r_github_packages:
  - jimhester/covr

after_success:
  - Rscript -e 'covr::coveralls()'

after_failure:
  - if [ ${OS} = Darwin ]; then cat /Users/travis/build/graemeblair/DDestimate/DDestimate.Rcheck/00check.log; fi
  - if [ ${OS} = Darwin ]; then cat /Users/travis/build/graemeblair/DDestimate/DDestimate.Rcheck/00install.out; fi
  - if [ ${OS} != Darwin ]; then cat /home/travis/build/graemeblair/DDestimate/DDestimate.Rcheck/00check.log; fi
  - if [ ${OS} != Darwin ]; then cat /home/travis/build/graemeblair/DDestimate/DDestimate.Rcheck/00install.out; fi
  - ./travis-tool.sh dump_logs

notifications:
  email:
    recipients:
    - graeme.blair@ucla.edu
    - alex.coppock@yale.edu
    on_success: change
    on_failure: change
